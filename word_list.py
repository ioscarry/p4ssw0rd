"""
Sources:
ftp://ftp.openwall.com/pub/wordlists/
http://www.skullsecurity.org/wiki/index.php/Passwords
http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists
http://contest-2010.korelogic.com/wordlists.html
"""

import os, re, mmap, string
import binary_search
import cProfile

regexNotLowercase = re.compile("[^a-z]")
regexNotLowercaseApostrophe = re.compile("[^a-z']")

type = ['letter','digit','letterapostrophe','combined']
wordPath = "words"
workPath = os.path.join("words", "work")

# Defines the order in which wordlists are searched - used for convertFiles only
wordsOrder = [
    "openwall-password.dic",
    "rockyou_top1000.dic",
    "numbers_as_words.dic",
    "names.dic",
    "tv-1-5000-special.dic",
    "tv-1-5000.dic",
    "tv-5000-10000-special.dic",
    "tv-5000-10000.dic",
    "english-tiny-cap.dic",
    "english-tiny-lower.dic",
    "contemporaryfiction-special.dic",
    "contemporaryfiction.dic",
    "bible_books.dic",
    "cities.dic",
    "places.dic",
    "english-small-alnum.dic",
    "english-small-cap.dic",
    "english-small-lower.dic",
    "english-small-mixed.dic",
    "sports.dic",
    "sports_proteams.dic",
    "english-large-acronym.dic",
    "english-large-alnum.dic",
    "english-large-cap.dic",
    "english-large-lower.dic",
    "english-large-mixed.dic",
    "english-extra-acronym.dic",
    "english-extra-alnum.dic",
    "english-extra-cap.dic",
    "english-extra-lower.dic",
    "english-extra-mixed.dic",
]

wordFiles = {
    1:{"name":"1.dic", "handle":None, "letterIndex":{'*': (0, 5), '-': (5, 15), '1': (15, 21), 'A': (21, 31), 'C': (41, 51), 'B': (31, 41), 'E': (61, 71), 'D': (51, 61), 'G': (81, 91), 'F': (71, 81), 'I': (101, 111), 'H': (91, 101), 'K': (121, 131), 'J': (111, 121), 'M': (141, 151), 'L': (131, 141), 'O': (161, 171), 'N': (151, 161), 'Q': (181, 191), 'P': (171, 181), 'S': (201, 211), 'R': (191, 201), 'U': (221, 231), 'T': (211, 221), 'W': (241, 251), 'V': (231, 241), 'Y': (261, 271), 'X': (251, 261), 'Z': (271, 281), '_': (281, 288), 'a': (288, 298), 'c': (308, 318), 'b': (298, 308), 'e': (328, 338), 'd': (318, 328), 'g': (348, 358), 'f': (338, 348), 'i': (368, 378), 'h': (358, 368), 'k': (388, 398), 'j': (378, 388), 'm': (408, 418), 'l': (398, 408), 'o': (428, 438), 'n': (418, 428), 'q': (448, 458), 'p': (438, 448), 's': (468, 478), 'r': (458, 468), 'u': (488, 498), 't': (478, 488), 'w': (508, 518), 'v': (498, 508), 'y': (528, 538), 'x': (518, 528), 'z': (538, 548)}},
    10:{"name":"10.dic", "handle":None, "letterIndex":{"'": (0, 19), '-': (19, 152), '1': (186, 222), '0': (152, 186), 'A': (222, 19982), 'C': (36252, 57733), 'B': (19982, 36252), 'E': (68360, 76870), 'D': (57733, 68360), 'G': (85654, 95183), 'F': (76870, 85654), 'I': (105671, 112488), 'H': (95183, 105671), 'K': (116739, 121719), 'J': (112488, 116739), 'M': (131858, 151322), 'L': (121719, 131858), 'O': (161142, 165982), 'N': (151322, 161142), 'Q': (183978, 184878), 'P': (165982, 183978), 'S': (192643, 215800), 'R': (184878, 192643), 'U': (228576, 233526), 'T': (215800, 228576), 'W': (237993, 245491), 'V': (233526, 237993), 'Y': (246718, 247758), 'X': (245491, 246718), 'Z': (247758, 248787), 'a': (248787, 367586), 'c': (481824, 646537), 'b': (367586, 481824), 'e': (749638, 824539), 'd': (646537, 749638), 'g': (913058, 977303), 'f': (824539, 913058), 'i': (1055728, 1119613), 'h': (977303, 1055728), 'k': (1134531, 1161855), 'j': (1119613, 1134531), 'm': (1225831, 1339290), 'l': (1161855, 1225831), 'o': (1396466, 1454056), 'n': (1339290, 1396466), 'q': (1616126, 1625009), 'p': (1454056, 1616126), 's': (1715099, 1936683), 'r': (1625009, 1715099), 'u': (2045126, 2122256), 't': (1936683, 2045126), 'w': (2154857, 2209608), 'v': (2122256, 2154857), 'y': (2218337, 2223805), 'x': (2209608, 2218337), 'z': (2223805, 2230373)}},
    11:{"name":"11.dic", "handle":None, "letterIndex":{"'": (0, 20), '1': (20, 38), '3': (38, 58), 'A': (58, 17525), 'C': (30386, 49041), 'B': (17525, 30386), 'E': (58772, 65609), 'D': (49041, 58772), 'G': (73226, 81414), 'F': (65609, 73226), 'I': (91092, 97362), 'H': (81414, 91092), 'K': (101453, 105095), 'J': (97362, 101453), 'M': (113550, 129565), 'L': (105095, 113550), 'O': (138170, 142928), 'N': (129565, 138170), 'Q': (160567, 161212), 'P': (142928, 160567), 'S': (167502, 187350), 'R': (161212, 167502), 'U': (197591, 202362), 'T': (187350, 197591), 'W': (205295, 211079), 'V': (202362, 205295), 'Y': (212054, 212754), 'X': (211079, 212054), 'Z': (212754, 213473), 'a': (213473, 317718), 'c': (412601, 564714), 'b': (317718, 412601), 'e': (653518, 713984), 'd': (564714, 653518), 'g': (787054, 841402), 'f': (713984, 787054), 'i': (912810, 974758), 'h': (841402, 912810), 'k': (985062, 1004376), 'j': (974758, 985062), 'm': (1057902, 1153936), 'l': (1004376, 1057902), 'o': (1211212, 1262577), 'n': (1153936, 1211212), 'q': (1415410, 1423822), 'p': (1262577, 1415410), 's': (1501538, 1699079), 'r': (1423822, 1501538), 'u': (1798371, 1875262), 't': (1699079, 1798371), 'w': (1902503, 1953429), 'v': (1875262, 1902503), 'y': (1959940, 1964486), 'x': (1953429, 1959940), 'z': (1964486, 1969251)}},
    12:{"name":"12.dic", "handle":None, "letterIndex":{"'": (0, 21), '-': (21, 42), 'A': (42, 13773), 'C': (24370, 39433), 'B': (13773, 24370), 'E': (46720, 53265), 'D': (39433, 46720), 'G': (60088, 67128), 'F': (53265, 60088), 'I': (75105, 80357), 'H': (67128, 75105), 'K': (83696, 86723), 'J': (80357, 83696), 'M': (93786, 107253), 'L': (86723, 93786), 'O': (113965, 117826), 'N': (107253, 113965), 'Q': (133650, 134128), 'P': (117826, 133650), 'S': (140054, 159482), 'R': (134128, 140054), 'U': (168534, 171552), 'T': (159482, 168534), 'W': (174711, 179867), 'V': (171552, 174711), 'Y': (181040, 181628), 'X': (179867, 181040), 'Z': (181628, 182489), 'a': (182489, 264141), 'c': (340038, 469517), 'b': (264141, 340038), 'e': (540965, 591280), 'd': (469517, 540965), 'g': (651379, 694602), 'f': (591280, 651379), 'i': (753006, 809724), 'h': (694602, 753006), 'k': (816583, 829540), 'j': (809724, 816583), 'm': (873335, 953347), 'l': (829540, 873335), 'o': (1011152, 1052576), 'n': (953347, 1011152), 'q': (1183546, 1193638), 'p': (1052576, 1183546), 's': (1257812, 1430321), 'r': (1193638, 1257812), 'u': (1516759, 1589973), 't': (1430321, 1516759), 'w': (1610855, 1655670), 'v': (1589973, 1610855), 'y': (1660207, 1663746), 'x': (1655670, 1660207), 'z': (1663746, 1667111)}},
    13:{"name":"13.dic", "handle":None, "letterIndex":{'-': (0, 22), 'A': (22, 9728), 'C': (18298, 31616), 'B': (9728, 18298), 'E': (37199, 41673), 'D': (31616, 37199), 'G': (46576, 51809), 'F': (41673, 46576), 'I': (57861, 62341), 'H': (51809, 57861), 'K': (65342, 67392), 'J': (62341, 65342), 'M': (72260, 81907), 'L': (67392, 72260), 'O': (87985, 90945), 'N': (81907, 87985), 'Q': (104079, 104509), 'P': (90945, 104079), 'S': (109256, 123461), 'R': (104509, 109256), 'U': (130224, 132634), 'T': (123461, 130224), 'W': (135193, 139222), 'V': (132634, 135193), 'Y': (140115, 140915), 'X': (139222, 140115), 'Z': (140915, 141548), 'a': (141548, 204943), 'c': (261816, 365723), 'b': (204943, 261816), 'e': (420589, 457432), 'd': (365723, 420589), 'g': (499981, 530355), 'f': (457432, 499981), 'i': (574336, 619839), 'h': (530355, 574336), 'k': (624977, 634505), 'j': (619839, 624977), 'm': (666491, 728503), 'l': (634505, 666491), 'o': (784332, 817419), 'n': (728503, 784332), 'q': (930264, 941039), 'p': (817419, 930264), 's': (990629, 1133607), 'r': (941039, 990629), 'u': (1202936, 1262483), 't': (1133607, 1202936), 'w': (1278992, 1312527), 'v': (1262483, 1278992), 'y': (1315623, 1318690), 'x': (1312527, 1315623), 'z': (1318690, 1321056)}},
    14:{"name":"14.dic", "handle":None, "letterIndex":{'(': (0, 23), 'A': (23, 8755), 'C': (15424, 26338), 'B': (8755, 15424), 'E': (30777, 34563), 'D': (26338, 30777), 'G': (38909, 43294), 'F': (34563, 38909), 'I': (48265, 51483), 'H': (43294, 48265), 'K': (53715, 56018), 'J': (51483, 53715), 'M': (60249, 68212), 'L': (56018, 60249), 'O': (72607, 74934), 'N': (68212, 72607), 'Q': (85450, 85880), 'P': (74934, 85450), 'S': (90127, 101745), 'R': (85880, 90127), 'U': (107006, 108849), 'T': (101745, 107006), 'W': (111166, 113747), 'V': (108849, 111166), 'Y': (114058, 114561), 'X': (113747, 114058), 'Z': (114561, 114962), 'a': (114962, 165902), 'c': (208726, 286002), 'b': (165902, 208726), 'e': (327302, 354901), 'd': (286002, 327302), 'g': (387328, 410753), 'f': (354901, 387328), 'i': (444700, 478918), 'h': (410753, 444700), 'k': (482064, 488150), 'j': (478918, 482064), 'm': (511426, 557398), 'l': (488150, 511426), 'o': (603578, 630050), 'n': (557398, 603578), 'q': (716558, 727246), 'p': (630050, 716558), 's': (764120, 878753), 'r': (727246, 764120), 'u': (932111, 978776), 't': (878753, 932111), 'w': (991580, 1017860), 'v': (978776, 991580), 'y': (1020986, 1023431), 'x': (1017860, 1020986), 'z': (1023431, 1025086)}},
    15:{"name":"15.dic", "handle":None, "letterIndex":{'A': (0, 6837), 'C': (12778, 21467), 'B': (6837, 12778), 'E': (24455, 27232), 'D': (21467, 24455), 'G': (30677, 33941), 'F': (27232, 30677), 'I': (37180, 39667), 'H': (33941, 37180), 'K': (41363, 42868), 'J': (39667, 41363), 'M': (46354, 52970), 'L': (42868, 46354), 'O': (55989, 57927), 'N': (52970, 55989), 'Q': (65553, 66028), 'P': (57927, 65553), 'S': (68669, 76575), 'R': (66028, 68669), 'U': (80256, 81878), 'T': (76575, 80256), 'W': (83748, 86271), 'V': (81878, 83748), 'Y': (86521, 86846), 'X': (86271, 86521), 'Z': (86846, 87068), 'a': (87068, 123131), 'c': (152987, 211330), 'b': (123131, 152987), 'e': (240549, 260940), 'd': (211330, 240549), 'g': (283797, 300151), 'f': (260940, 283797), 'i': (326694, 353571), 'h': (300151, 326694), 'k': (356681, 361513), 'j': (353571, 356681), 'm': (378874, 412883), 'l': (361513, 378874), 'o': (449355, 468902), 'n': (412883, 449355), 'q': (532297, 541693), 'p': (468902, 532297), 's': (566931, 652000), 'r': (541693, 566931), 'u': (691644, 724444), 't': (652000, 691644), 'w': (734606, 752390), 'v': (724444, 734606), 'y': (755105, 756578), 'x': (752390, 755105), 'z': (756578, 757691)}},
    16:{"name":"16.dic", "handle":None, "letterIndex":{'A': (0, 5444), 'C': (9674, 16316), 'B': (5444, 9674), 'E': (18635, 21075), 'D': (16316, 18635), 'G': (23584, 25755), 'F': (21075, 23584), 'I': (28271, 30496), 'H': (25755, 28271), 'K': (31756, 32851), 'J': (30496, 31756), 'M': (35421, 40758), 'L': (32851, 35421), 'O': (42938, 44156), 'N': (40758, 42938), 'Q': (50005, 50213), 'P': (44156, 50005), 'S': (52549, 59048), 'R': (50213, 52549), 'U': (61926, 62836), 'T': (59048, 61926), 'W': (63975, 65741), 'V': (62836, 63975), 'Y': (66001, 66105), 'X': (65741, 66001), 'Z': (66105, 66285), 'a': (66285, 94496), 'c': (115096, 155513), 'b': (94496, 115096), 'e': (176030, 192372), 'd': (155513, 176030), 'g': (209738, 223168), 'f': (192372, 209738), 'i': (241777, 261247), 'h': (223168, 241777), 'k': (262671, 265833), 'j': (261247, 262671), 'm': (277919, 301713), 'l': (265833, 277919), 'o': (326703, 342134), 'n': (301713, 326703), 'q': (387618, 395942), 'p': (342134, 387618), 's': (412483, 471972), 'r': (395942, 412483), 'u': (498447, 520281), 't': (471972, 498447), 'w': (526386, 539128), 'v': (520281, 526386), 'y': (540790, 541700), 'x': (539128, 540790), 'z': (541700, 542371)}},
    17:{"name":"17.dic", "handle":None, "letterIndex":{'1': (0, 26), 'A': (26, 4142), 'C': (6964, 12185), 'B': (4142, 6964), 'E': (14063, 15917), 'D': (12185, 14063), 'G': (17606, 19342), 'F': (15917, 17606), 'I': (21034, 22411), 'H': (19342, 21034), 'K': (23116, 24154), 'J': (22411, 23116), 'M': (25961, 29649), 'L': (24154, 25961), 'O': (31970, 33316), 'N': (29649, 31970), 'Q': (37083, 37191), 'P': (33316, 37083), 'S': (38807, 43578), 'R': (37191, 38807), 'U': (45463, 46030), 'T': (43578, 45463), 'W': (46813, 47974), 'V': (46030, 46813), 'Y': (48082, 48244), 'X': (47974, 48082), 'Z': (48244, 48351), 'a': (48351, 70374), 'c': (84280, 114712), 'b': (70374, 84280), 'e': (128890, 139281), 'd': (114712, 128890), 'g': (151627, 162129), 'f': (139281, 151627), 'i': (175304, 189527), 'h': (162129, 175304), 'k': (190495, 192268), 'j': (189527, 190495), 'm': (201318, 219541), 'l': (192268, 201318), 'o': (237041, 247833), 'n': (219541, 237041), 'q': (280449, 286239), 'p': (247833, 280449), 's': (299433, 339640), 'r': (286239, 299433), 'u': (361192, 374420), 't': (339640, 361192), 'w': (378533, 386923), 'v': (374420, 378533), 'y': (388327, 389218), 'x': (386923, 388327), 'z': (389218, 389834)}},
    18:{"name":"18.dic", "handle":None, "letterIndex":{'A': (0, 2927), 'C': (4819, 8452), 'B': (2927, 4819), 'E': (9634, 11035), 'D': (8452, 9634), 'G': (12542, 13793), 'F': (11035, 12542), 'I': (15351, 16426), 'H': (13793, 15351), 'K': (17296, 18150), 'J': (16426, 17296), 'M': (19353, 21562), 'L': (18150, 19353), 'O': (22598, 23353), 'N': (21562, 22598), 'Q': (25307, 25475), 'P': (23353, 25307), 'S': (26370, 29140), 'R': (25475, 26370), 'U': (30204, 30764), 'T': (29140, 30204), 'W': (31324, 32108), 'V': (30764, 31324), 'Y': (32248, 32332), 'X': (32108, 32248), 'Z': (32332, 32444), 'a': (32444, 48991), 'c': (59149, 80466), 'b': (48991, 59149), 'e': (91001, 99871), 'd': (80466, 91001), 'g': (108908, 116865), 'f': (99871, 108908), 'i': (126544, 137815), 'h': (116865, 126544), 'k': (139046, 140810), 'j': (137815, 139046), 'm': (148048, 159989), 'l': (140810, 148048), 'o': (170188, 177761), 'n': (159989, 170188), 'q': (201074, 204625), 'p': (177761, 201074), 's': (213722, 242344), 'r': (204625, 213722), 'u': (257950, 265176), 't': (242344, 257950), 'w': (268355, 274369), 'v': (265176, 268355), 'y': (275517, 275993), 'x': (274369, 275517), 'z': (275993, 276381)}},
    19:{"name":"19.dic", "handle":None, "letterIndex":{'$': (0, 28), 'A': (28, 2384), 'C': (3800, 6868), 'B': (2384, 3800), 'E': (8181, 8981), 'D': (6868, 8181), 'G': (9801, 10734), 'F': (8981, 9801), 'I': (11439, 12409), 'H': (10734, 11439), 'K': (12887, 13313), 'J': (12409, 12887), 'M': (14444, 16414), 'L': (13313, 14444), 'O': (17313, 17835), 'N': (16414, 17313), 'Q': (19863, 19979), 'P': (17835, 19863), 'S': (20762, 23430), 'R': (19979, 20762), 'U': (24619, 24909), 'T': (23430, 24619), 'W': (25460, 26069), 'V': (24909, 25460), 'Y': (26127, 26243), 'X': (26069, 26127), 'Z': (26243, 26301), 'a': (26301, 37556), 'c': (44785, 61187), 'b': (37556, 44785), 'e': (69220, 76674), 'd': (61187, 69220), 'g': (82471, 88925), 'f': (76674, 82471), 'i': (97192, 105646), 'h': (88925, 97192), 'k': (106284, 107559), 'j': (105646, 106284), 'm': (112799, 122016), 'l': (107559, 112799), 'o': (128717, 134024), 'n': (122016, 128717), 'q': (151182, 153385), 'p': (134024, 151182), 's': (161025, 179670), 'r': (153385, 161025), 'u': (190638, 195208), 't': (179670, 190638), 'w': (197757, 201989), 'v': (195208, 197757), 'y': (203062, 203439), 'x': (201989, 203062), 'z': (203439, 203669)}},
    2:{"name":"2.dic", "handle":None, "letterIndex":{"'": (11, 55), '&': (0, 11), '-': (55, 132), '3': (143, 165), '2': (132, 143), '4': (165, 176), 'A': (176, 704), 'C': (1067, 1529), 'B': (704, 1067), 'E': (1903, 2255), 'D': (1529, 1903), 'G': (2541, 2893), 'F': (2255, 2541), 'I': (3278, 3685), 'H': (2893, 3278), 'K': (3872, 4147), 'J': (3685, 3872), 'M': (4565, 5006), 'L': (4147, 4565), 'O': (5358, 5788), 'N': (5006, 5358), 'Q': (6250, 6426), 'P': (5788, 6250), 'S': (6844, 7273), 'R': (6426, 6844), 'U': (7669, 7922), 'T': (7273, 7669), 'W': (8241, 8516), 'V': (7922, 8241), 'Y': (8681, 8824), 'X': (8516, 8681), 'Z': (8824, 8956), '\\': (8956, 9076), 'a': (9076, 9495), 'c': (9833, 10207), 'b': (9495, 9833), 'e': (10713, 11159), 'd': (10207, 10713), 'g': (11547, 11941), 'f': (11159, 11547), 'i': (12330, 12899), 'h': (11941, 12330), 'k': (13252, 13788), 'j': (12899, 13252), 'm': (14223, 14680), 'l': (13788, 14223), 'o': (15235, 15768), 'n': (14680, 15235), 'q': (16301, 16768), 'p': (15768, 16301), 's': (17307, 17777), 'r': (16768, 17307), 'u': (18298, 18813), 't': (17777, 18298), 'w': (19338, 19871), 'v': (18813, 19338), 'y': (20424, 20954), 'x': (19871, 20424), 'z': (20954, 21453)}},
    20:{"name":"20.dic", "handle":None, "letterIndex":{'A': (0, 1783), 'C': (3184, 4971), 'B': (1783, 3184), 'E': (5735, 6766), 'D': (4971, 5735), 'G': (7640, 8517), 'F': (6766, 7640), 'I': (9250, 10022), 'H': (8517, 9250), 'K': (10604, 11017), 'J': (10022, 10604), 'M': (11976, 13354), 'L': (11017, 11976), 'O': (13834, 14134), 'N': (13354, 13834), 'Q': (15724, 15904), 'P': (14134, 15724), 'S': (16654, 18724), 'R': (15904, 16654), 'U': (19444, 19774), 'T': (18724, 19444), 'W': (20074, 20794), 'V': (19774, 20074), 'X': (20794, 20854), 'a': (20854, 30113), 'c': (35953, 48375), 'b': (30113, 35953), 'e': (54573, 60036), 'd': (48375, 54573), 'g': (64386, 69331), 'f': (60036, 64386), 'i': (74582, 81015), 'h': (69331, 74582), 'k': (81375, 82724), 'j': (81015, 81375), 'm': (86198, 92206), 'l': (82724, 86198), 'o': (96128, 99737), 'n': (92206, 96128), 'q': (113127, 114927), 'p': (99737, 113127), 's': (120382, 133216), 'r': (114927, 120382), 'u': (142110, 145082), 't': (133216, 142110), 'w': (146851, 150448), 'v': (145082, 146851), 'y': (151288, 151557), 'x': (150448, 151288), 'z': (151557, 151587)}},
    21:{"name":"21.dic", "handle":None, "letterIndex":{'A': (0, 1309), 'C': (2245, 4094), 'B': (1309, 2245), 'E': (4789, 5370), 'D': (4094, 4789), 'G': (5973, 6665), 'F': (5370, 5973), 'I': (7029, 7426), 'H': (6665, 7029), 'K': (7636, 7820), 'J': (7426, 7636), 'M': (8533, 9617), 'L': (7820, 8533), 'O': (9958, 10175), 'N': (9617, 9958), 'P': (10175, 11507), 'S': (12313, 13491), 'R': (11507, 12313), 'U': (14111, 14359), 'T': (13491, 14111), 'W': (14731, 15041), 'V': (14359, 14731), 'X': (15041, 15072), 'a': (15072, 21162), 'c': (25436, 33720), 'b': (21162, 25436), 'e': (38731, 42224), 'd': (33720, 38731), 'g': (45323, 48947), 'f': (42224, 45323), 'i': (52125, 56518), 'h': (48947, 52125), 'k': (56765, 57478), 'j': (56518, 56765), 'm': (59740, 64999), 'l': (57478, 59740), 'o': (67627, 69693), 'n': (64999, 67627), 'q': (77071, 77629), 'p': (69693, 77071), 's': (81596, 90880), 'r': (77629, 81596), 'u': (97969, 99667), 't': (90880, 97969), 'w': (100628, 103387), 'v': (99667, 100628), 'y': (104224, 104440), 'x': (103387, 104224), 'z': (104440, 104470)}},
    22:{"name":"22.dic", "handle":None, "letterIndex":{'A': (0, 879), 'C': (1471, 2414), 'B': (879, 1471), 'E': (2884, 3388), 'D': (2414, 2884), 'G': (3920, 4265), 'F': (3388, 3920), 'I': (4545, 4831), 'H': (4265, 4545), 'K': (5080, 5206), 'J': (4831, 5080), 'M': (5718, 6678), 'L': (5206, 5718), 'O': (7094, 7286), 'N': (6678, 7094), 'Q': (7765, 7797), 'P': (7286, 7765), 'S': (8597, 9589), 'R': (7797, 8597), 'U': (9973, 10197), 'T': (9589, 9973), 'W': (10261, 10645), 'V': (10197, 10261), 'Y': (10677, 10709), 'X': (10645, 10677), 'Z': (10709, 10773), 'a': (10773, 15953), 'c': (19312, 25862), 'b': (15953, 19312), 'e': (29918, 33336), 'd': (25862, 29918), 'g': (36119, 38807), 'f': (33336, 36119), 'i': (41936, 45167), 'h': (38807, 41936), 'k': (45423, 46190), 'j': (45167, 45423), 'm': (48268, 51463), 'l': (46190, 48268), 'o': (53634, 54974), 'n': (51463, 53634), 'q': (60529, 60913), 'p': (54974, 60529), 's': (63409, 70475), 'r': (60913, 63409), 'u': (74919, 76165), 't': (70475, 74919), 'w': (76997, 78757), 'v': (76165, 76997), 'y': (79365, 79525), 'x': (78757, 79365), 'z': (79525, 79620)}},
    23:{"name":"23.dic", "handle":None, "letterIndex":{'A': (0, 681), 'C': (970, 1839), 'B': (681, 970), 'E': (2229, 2518), 'D': (1839, 2229), 'G': (2872, 3128), 'F': (2518, 2872), 'I': (3354, 3809), 'H': (3128, 3354), 'K': (4002, 4035), 'J': (3809, 4002), 'M': (4332, 5025), 'L': (4035, 4332), 'O': (5289, 5487), 'N': (5025, 5289), 'Q': (5981, 6080), 'P': (5487, 5981), 'S': (6476, 7136), 'R': (6080, 6476), 'U': (7664, 7829), 'T': (7136, 7664), 'W': (8126, 8423), 'V': (7829, 8126), 'Y': (8522, 8555), 'X': (8423, 8522), 'a': (8555, 11986), 'c': (13998, 19112), 'b': (11986, 13998), 'e': (21682, 23658), 'd': (19112, 21682), 'g': (25339, 27384), 'f': (23658, 25339), 'i': (29329, 31936), 'h': (27384, 29329), 'k': (32167, 32826), 'j': (31936, 32167), 'm': (34971, 37538), 'l': (32826, 34971), 'o': (39155, 40374), 'n': (37538, 39155), 'q': (45017, 45182), 'p': (40374, 45017), 's': (47063, 51814), 'r': (45182, 47063), 'u': (55871, 56728), 't': (51814, 55871), 'w': (57355, 59202), 'v': (56728, 57355), 'y': (59697, 59796), 'x': (59202, 59697), 'z': (59796, 59862)}},
    24:{"name":"24.dic", "handle":None, "letterIndex":{'A': (0, 701), 'C': (933, 1564), 'B': (701, 933), 'E': (1830, 2230), 'D': (1564, 1830), 'G': (2496, 2697), 'F': (2230, 2496), 'I': (2995, 3464), 'H': (2697, 2995), 'K': (3663, 3696), 'J': (3464, 3663), 'M': (4138, 4410), 'L': (3696, 4138), 'O': (4580, 4682), 'N': (4410, 4580), 'P': (4682, 4920), 'S': (5124, 5600), 'R': (4920, 5124), 'U': (5804, 5906), 'T': (5600, 5804), 'W': (6008, 6144), 'V': (5906, 6008), 'X': (6144, 6246), 'a': (6246, 9612), 'c': (11380, 14848), 'b': (9612, 11380), 'e': (17192, 19061), 'd': (14848, 17192), 'g': (20420, 21984), 'f': (19061, 20420), 'i': (23956, 25962), 'h': (21984, 23956), 'k': (26030, 26574), 'j': (25962, 26030), 'm': (27628, 29598), 'l': (26574, 27628), 'o': (30414, 31434), 'n': (29598, 30414), 'q': (35171, 35443), 'p': (31434, 35171), 's': (36871, 39963), 'r': (35443, 36871), 'u': (43191, 43972), 't': (39963, 43191), 'w': (44414, 45502), 'v': (43972, 44414), 'y': (45808, 45876), 'x': (45502, 45808)}},
    25:{"name":"25.dic", "handle":None, "letterIndex":{'A': (0, 377), 'C': (581, 1025), 'B': (377, 581), 'E': (1298, 1607), 'D': (1025, 1298), 'G': (1881, 2260), 'F': (1607, 1881), 'I': (2466, 2672), 'H': (2260, 2466), 'K': (2740, 2877), 'J': (2672, 2740), 'M': (3087, 3577), 'L': (2877, 3087), 'O': (3892, 3997), 'N': (3577, 3892), 'Q': (4207, 4277), 'P': (3997, 4207), 'S': (4662, 5012), 'R': (4277, 4662), 'U': (5327, 5362), 'T': (5012, 5327), 'W': (5362, 5537), 'Y': (5607, 5677), 'X': (5537, 5607), 'a': (5677, 7741), 'c': (9176, 11310), 'b': (7741, 9176), 'e': (12219, 13513), 'd': (11310, 12219), 'g': (14318, 15438), 'f': (13513, 14318), 'i': (16698, 18097), 'h': (15438, 16698), 'k': (18167, 18482), 'j': (18097, 18167), 'm': (19532, 21386), 'l': (18482, 19532), 'o': (22401, 23171), 'n': (21386, 22401), 'q': (25445, 25585), 'p': (23171, 25445), 's': (26494, 28733), 'r': (25585, 26494), 'u': (30378, 30868), 't': (28733, 30378), 'w': (31078, 31848), 'v': (30868, 31078), 'y': (32163, 32198), 'x': (31848, 32163), 'z': (32198, 32268)}},
    26:{"name":"26.dic", "handle":None, "letterIndex":{'A': (0, 389), 'C': (530, 986), 'B': (389, 530), 'E': (1161, 1268), 'D': (986, 1161), 'G': (1443, 1724), 'F': (1268, 1443), 'I': (1759, 2042), 'H': (1724, 1759), 'K': (2077, 2255), 'J': (2042, 2077), 'M': (2399, 2759), 'L': (2255, 2399), 'O': (2903, 2975), 'N': (2759, 2903), 'P': (2975, 3227), 'S': (3443, 3767), 'R': (3227, 3443), 'U': (3947, 4163), 'T': (3767, 3947), 'W': (4199, 4307), 'V': (4163, 4199), 'Y': (4307, 4343), 'a': (4343, 5819), 'c': (6791, 8123), 'b': (5819, 6791), 'e': (9023, 9707), 'd': (8123, 9023), 'g': (10751, 11399), 'f': (9707, 10751), 'i': (12803, 13631), 'h': (11399, 12803), 'k': (13775, 14135), 'j': (13631, 13775), 'm': (14927, 16007), 'l': (14135, 14927), 'o': (16799, 17447), 'n': (16007, 16799), 'q': (19211, 19319), 'p': (17447, 19211), 's': (20111, 22055), 'r': (19319, 20111), 'u': (24142, 24502), 't': (22055, 24142), 'w': (24574, 25186), 'v': (24502, 24574), 'y': (25582, 25726), 'x': (25186, 25582)}},
    27:{"name":"27.dic", "handle":None, "letterIndex":{'A': (0, 253), 'C': (578, 939), 'B': (253, 578), 'E': (1263, 1554), 'D': (939, 1263), 'G': (1698, 1734), 'F': (1554, 1698), 'I': (1879, 1987), 'H': (1734, 1879), 'K': (1987, 2024), 'M': (2172, 2394), 'L': (2024, 2172), 'O': (2579, 2653), 'N': (2394, 2579), 'P': (2653, 2801), 'S': (2838, 3134), 'R': (2801, 2838), 'U': (3208, 3282), 'T': (3134, 3208), 'W': (3282, 3356), 'a': (3356, 4577), 'c': (5206, 7019), 'b': (4577, 5206), 'e': (7537, 8091), 'd': (7019, 7537), 'g': (8720, 9275), 'f': (8091, 8720), 'i': (9977, 10865), 'h': (9275, 9977), 'k': (10865, 11272), 'm': (11716, 12418), 'l': (11272, 11716), 'o': (13195, 13491), 'n': (12418, 13195), 'q': (14675, 14749), 'p': (13491, 14675), 's': (15156, 16266), 'r': (14749, 15156), 'u': (17783, 18153), 't': (16266, 17783), 'w': (18153, 19004), 'y': (19263, 19374), 'x': (19004, 19263)}},
    28:{"name":"28.dic", "handle":None, "letterIndex":{'A': (0, 185), 'C': (333, 740), 'B': (185, 333), 'E': (1036, 1110), 'D': (740, 1036), 'G': (1258, 1295), 'F': (1110, 1258), 'I': (1332, 1406), 'H': (1295, 1332), 'J': (1406, 1443), 'M': (1557, 1747), 'L': (1443, 1557), 'O': (1975, 2013), 'N': (1747, 1975), 'P': (2013, 2051), 'S': (2203, 2317), 'R': (2051, 2203), 'U': (2469, 2545), 'T': (2317, 2469), 'W': (2545, 2697), 'a': (2697, 3798), 'c': (4368, 4786), 'b': (3798, 4368), 'e': (5204, 5660), 'd': (4786, 5204), 'g': (6040, 6268), 'f': (5660, 6040), 'i': (7141, 7559), 'h': (6268, 7141), 'k': (7635, 7749), 'j': (7559, 7635), 'm': (8281, 8927), 'l': (7749, 8281), 'o': (9535, 9725), 'n': (8927, 9535), 'q': (10789, 10827), 'p': (9725, 10789), 's': (11207, 12613), 'r': (10827, 11207), 'u': (13943, 14019), 't': (12613, 13943), 'w': (14133, 14475), 'v': (14019, 14133), 'z': (14475, 14513)}},
    29:{"name":"29.dic", "handle":None, "letterIndex":{'A': (0, 228), 'C': (266, 380), 'B': (228, 266), 'E': (494, 646), 'D': (380, 494), 'G': (836, 912), 'F': (646, 836), 'I': (950, 988), 'H': (912, 950), 'M': (1183, 1300), 'L': (988, 1183), 'O': (1378, 1417), 'N': (1300, 1378), 'P': (1417, 1456), 'S': (1612, 1846), 'R': (1456, 1612), 'T': (1846, 1885), 'W': (1924, 2119), 'V': (1885, 1924), 'a': (2119, 2704), 'c': (3016, 3912), 'b': (2704, 3016), 'e': (4185, 4536), 'd': (3912, 4185), 'g': (4770, 5238), 'f': (4536, 4770), 'i': (5706, 6018), 'h': (5238, 5706), 'k': (6057, 6291), 'j': (6018, 6057), 'm': (6876, 7344), 'l': (6291, 6876), 'o': (7695, 7851), 'n': (7344, 7695), 'p': (7851, 8358), 's': (8553, 9255), 'r': (8358, 8553), 'u': (10775, 10970), 't': (9255, 10775), 'w': (11048, 11633), 'v': (10970, 11048), 'y': (11633, 11672)}},
    3:{"name":"3.dic", "handle":None, "letterIndex":{"'": (0, 60), '-': (60, 564), '1': (571, 591), '0': (564, 571), '3': (603, 647), '2': (591, 603), '5': (683, 707), '4': (647, 683), '7': (719, 739), '6': (707, 719), '9': (751, 771), '8': (739, 751), 'A': (771, 7140), 'C': (12306, 18469), 'B': (7140, 12306), 'E': (23879, 28375), 'D': (18469, 23879), 'G': (32618, 36604), 'F': (28375, 32618), 'I': (40058, 44355), 'H': (36604, 40058), 'K': (47163, 49992), 'J': (44355, 47163), 'M': (54462, 61070), 'L': (49992, 54462), 'O': (64366, 66879), 'N': (61070, 64366), 'Q': (70986, 72108), 'P': (66879, 70986), 'S': (75594, 80632), 'R': (72108, 75594), 'U': (84072, 86142), 'T': (80632, 84072), 'W': (88249, 90352), 'V': (86142, 88249), 'Y': (91693, 92602), 'X': (90352, 91693), 'Z': (92602, 93459), '\\': (93459, 93472), 'a': (93472, 103050), 'c': (112250, 121639), 'b': (103050, 112250), 'e': (130956, 140776), 'd': (121639, 130956), 'g': (150734, 159535), 'f': (140776, 150734), 'i': (168144, 176800), 'h': (159535, 168144), 'k': (185333, 194056), 'j': (176800, 185333), 'm': (202905, 212595), 'l': (194056, 202905), 'o': (221936, 230869), 'n': (212595, 221936), 'q': (240388, 248914), 'p': (230869, 240388), 's': (258286, 267942), 'r': (248914, 258286), 'u': (277341, 286101), 't': (267942, 277341), 'w': (294912, 303228), 'v': (286101, 294912), 'y': (311935, 319111), 'x': (303228, 311935), 'z': (319111, 325881)}},
    30:{"name":"30.dic", "handle":None, "letterIndex":{'A': (0, 117), 'C': (195, 312), 'B': (117, 195), 'E': (351, 507), 'D': (312, 351), 'G': (546, 585), 'F': (507, 546), 'I': (624, 819), 'H': (585, 624), 'M': (939, 1019), 'L': (819, 939), 'O': (1099, 1219), 'N': (1019, 1099), 'P': (1219, 1379), 'S': (1379, 1499), 'U': (1499, 1539), 'W': (1539, 1579), 'a': (1579, 2019), 'c': (2339, 2699), 'b': (2019, 2339), 'e': (2779, 3139), 'd': (2699, 2779), 'g': (3379, 3659), 'f': (3139, 3379), 'i': (4019, 4379), 'h': (3659, 4019), 'k': (4379, 4619), 'm': (4979, 5259), 'l': (4619, 4979), 'o': (5459, 5539), 'n': (5259, 5459), 'p': (5539, 6139), 's': (6259, 6779), 'r': (6139, 6259), 'u': (7819, 7859), 't': (6779, 7819), 'w': (7899, 8339), 'v': (7859, 7899), 'y': (8339, 8379)}},
    31:{"name":"31.dic", "handle":None, "letterIndex":{'A': (0, 200), 'C': (320, 440), 'B': (200, 320), 'E': (440, 640), 'G': (760, 800), 'F': (640, 760), 'I': (840, 1000), 'H': (800, 840), 'K': (1000, 1081), 'L': (1081, 1122), 'O': (1204, 1327), 'N': (1122, 1204), 'P': (1327, 1450), 'S': (1450, 1573), 'U': (1614, 1655), 'T': (1573, 1614), 'a': (1655, 2311), 'c': (2598, 3131), 'b': (2311, 2598), 'e': (3663, 3827), 'd': (3131, 3663), 'g': (4114, 4565), 'f': (3827, 4114), 'i': (5057, 5385), 'h': (4565, 5057), 'k': (5467, 5672), 'j': (5385, 5467), 'm': (6000, 6205), 'l': (5672, 6000), 'o': (6451, 6533), 'n': (6205, 6451), 'p': (6533, 6902), 's': (7025, 7476), 'r': (6902, 7025), 'u': (8419, 8542), 't': (7476, 8419), 'w': (8542, 8829), 'y': (8829, 8870)}},
    32:{"name":"32.dic", "handle":None, "letterIndex":{'A': (0, 123), 'C': (205, 369), 'B': (123, 205), 'E': (410, 451), 'D': (369, 410), 'G': (492, 615), 'F': (451, 492), 'I': (656, 738), 'H': (615, 656), 'K': (738, 904), 'O': (946, 988), 'N': (904, 946), 'S': (988, 1156), 'U': (1198, 1324), 'T': (1156, 1198), 'W': (1324, 1366), 'a': (1366, 1660), 'c': (1870, 2248), 'b': (1660, 1870), 'e': (2374, 2542), 'd': (2248, 2374), 'g': (2668, 2794), 'f': (2542, 2668), 'i': (3088, 3256), 'h': (2794, 3088), 'k': (3298, 3466), 'j': (3256, 3298), 'm': (3718, 3886), 'l': (3466, 3718), 'o': (4054, 4222), 'n': (3886, 4054), 'p': (4222, 4600), 's': (4684, 5104), 'r': (4600, 4684), 'u': (5860, 5986), 't': (5104, 5860), 'w': (5986, 6364)}},
    33:{"name":"33.dic", "handle":None, "letterIndex":{'I': (42, 84), 't': (84, 127), 'F': (0, 42)}},
    34:{"name":"34.dic", "handle":None, "letterIndex":{'i': (219, 263), 'S': (131, 219), 't': (263, 307), 'G': (0, 43), 'N': (43, 131)}},
    35:{"name":"35.dic", "handle":None, "letterIndex":{'c': (0, 0)}},
    36:{"name":"36.dic", "handle":None, "letterIndex":{'W': (0, 0)}},
    37:{"name":"37.dic", "handle":None, "letterIndex":{'I': (0, 46), 'i': (46, 93)}},
    39:{"name":"39.dic", "handle":None, "letterIndex":{'J': (0, 0)}},
    4:{"name":"4.dic", "handle":None, "letterIndex":{"'": (0, 39), '-': (39, 1274), '1': (1300, 1367), '0': (1274, 1300), '3': (1385, 1398), '2': (1367, 1385), '5': (1407, 1434), '4': (1398, 1407), '7': (1456, 1465), '6': (1434, 1456), 'A': (1465, 10053), 'C': (16555, 30655), 'B': (10053, 16555), 'E': (36619, 41699), 'D': (30655, 36619), 'G': (45675, 49677), 'F': (41699, 45675), 'I': (54167, 59129), 'H': (49677, 54167), 'K': (62073, 65901), 'J': (59129, 62073), 'M': (71166, 78918), 'L': (65901, 71166), 'O': (83784, 87662), 'N': (78918, 83784), 'Q': (92924, 93670), 'P': (87662, 92924), 'S': (98990, 106481), 'R': (93670, 98990), 'U': (111747, 114374), 'T': (106481, 111747), 'W': (117092, 120278), 'V': (114374, 117092), 'Y': (121675, 123036), 'X': (120278, 121675), 'Z': (123036, 124296), '\\': (124296, 124408), 'a': (124408, 167779), 'c': (198959, 245535), 'b': (167779, 198959), 'e': (279795, 317931), 'd': (245535, 279795), 'g': (345893, 369587), 'f': (317931, 345893), 'i': (394687, 425696), 'h': (369587, 394687), 'k': (443940, 467453), 'j': (425696, 443940), 'm': (493752, 530260), 'l': (467453, 493752), 'o': (559922, 582095), 'n': (530260, 559922), 'q': (612620, 620155), 'p': (582095, 612620), 's': (649642, 696358), 'r': (620155, 649642), 'u': (732303, 751960), 't': (696358, 732303), 'w': (769296, 789798), 'v': (751960, 769296), 'y': (802965, 814653), 'x': (789798, 802965), 'z': (814653, 823780)}},
    40:{"name":"40.dic", "handle":None, "letterIndex":{'s': (0, 0)}},
    42:{"name":"42.dic", "handle":None, "letterIndex":{'I': (0, 0)}},
    45:{"name":"45.dic", "handle":None, "letterIndex":{'p': (0, 0)}},
    5:{"name":"5.dic", "handle":None, "letterIndex":{'!': (0, 9), "'": (9, 51), '-': (51, 1843), '1': (1855, 1919), '0': (1843, 1855), '3': (1933, 1961), '2': (1919, 1933), '5': (1975, 1999), '4': (1961, 1975), '7': (1999, 2013), '9': (2023, 2043), '8': (2013, 2023), 'A': (2043, 17312), 'C': (29862, 50128), 'B': (17312, 29862), 'E': (60155, 67337), 'D': (50128, 60155), 'G': (73178, 80563), 'F': (67337, 73178), 'I': (88089, 94371), 'H': (80563, 88089), 'K': (99240, 106565), 'J': (94371, 99240), 'M': (116778, 129892), 'L': (106565, 116778), 'O': (137878, 143336), 'N': (129892, 137878), 'Q': (152145, 153094), 'P': (143336, 152145), 'S': (160575, 175051), 'R': (153094, 160575), 'U': (184186, 187729), 'T': (175051, 184186), 'W': (191956, 196239), 'V': (187729, 191956), 'Y': (198872, 200609), 'X': (196239, 198872), 'Z': (200609, 202541), '\\': (202541, 202556), 'a': (202556, 289600), 'c': (364952, 447390), 'b': (289600, 364952), 'e': (518590, 585370), 'd': (447390, 518590), 'g': (633607, 682434), 'f': (585370, 633607), 'i': (731548, 785952), 'h': (682434, 731548), 'k': (819424, 873908), 'j': (785952, 819424), 'm': (929476, 1005427), 'l': (873908, 929476), 'o': (1059878, 1093904), 'n': (1005427, 1059878), 'q': (1155280, 1162035), 'p': (1093904, 1155280), 's': (1222445, 1338712), 'r': (1162035, 1222445), 'u': (1414450, 1444222), 't': (1338712, 1414450), 'w': (1474850, 1503822), 'v': (1444222, 1474850), 'y': (1517269, 1539734), 'x': (1503822, 1517269), 'z': (1539734, 1555005)}},
    53:{"name":"53.dic", "handle":None, "letterIndex":{'I': (0, 0)}},
    6:{"name":"6.dic", "handle":None, "letterIndex":{'!': (0, 10), "'": (10, 160), '(': (160, 175), '-': (175, 2110), '1': (2173, 2475), '0': (2110, 2173), '3': (2566, 2594), '2': (2475, 2566), '5': (2648, 2674), '4': (2594, 2648), '7': (2713, 2752), '6': (2674, 2713), '9': (2765, 2791), '8': (2752, 2765), 'A': (2802, 23705), '@': (2791, 2802), 'C': (40997, 85412), 'B': (23705, 40997), 'E': (100295, 109242), 'D': (85412, 100295), 'G': (117945, 128861), 'F': (109242, 117945), 'I': (140721, 149235), 'H': (128861, 140721), 'K': (155192, 165407), 'J': (149235, 155192), 'M': (178406, 199099), 'L': (165407, 178406), 'O': (208681, 215795), 'N': (199099, 208681), 'Q': (229080, 230290), 'P': (215795, 229080), 'S': (240133, 261804), 'R': (230290, 240133), 'U': (275411, 279649), 'T': (261804, 275411), 'W': (285077, 292571), 'V': (279649, 285077), 'Y': (294686, 297021), 'X': (292571, 294686), 'Z': (297021, 299553), 'a': (299553, 430086), 'c': (562821, 699551), 'b': (430086, 562821), 'e': (809970, 894005), 'd': (699551, 809970), 'g': (969484, 1052094), 'f': (894005, 969484), 'i': (1128226, 1190339), 'h': (1052094, 1128226), 'k': (1233680, 1327940), 'j': (1190339, 1233680), 'm': (1417907, 1557572), 'l': (1327940, 1417907), 'o': (1635202, 1682487), 'n': (1557572, 1635202), 'q': (1794563, 1804196), 'p': (1682487, 1794563), 's': (1900864, 2098291), 'r': (1804196, 1900864), 'u': (2216156, 2257875), 't': (2098291, 2216156), 'w': (2300451, 2348474), 'v': (2257875, 2300451), 'y': (2362007, 2388502), 'x': (2348474, 2362007), 'z': (2388502, 2407991)}},
    7:{"name":"7.dic", "handle":None, "letterIndex":{'!': (0, 11), "'": (11, 155), '-': (155, 2043), '1': (2057, 2085), '0': (2043, 2057), '3': (2101, 2117), '2': (2085, 2101), '5': (2129, 2159), '4': (2117, 2129), '7': (2175, 2205), '6': (2159, 2175), '9': (2233, 2249), '8': (2205, 2233), 'A': (2249, 26616), 'C': (46658, 72082), 'B': (26616, 46658), 'E': (89229, 99294), 'D': (72082, 89229), 'G': (109875, 122981), 'F': (99294, 109875), 'I': (135440, 143674), 'H': (122981, 135440), 'K': (150246, 160327), 'J': (143674, 150246), 'M': (175314, 202286), 'L': (160327, 175314), 'O': (213364, 221079), 'N': (202286, 213364), 'Q': (238924, 240689), 'P': (221079, 238924), 'S': (252257, 279209), 'R': (240689, 252257), 'U': (295742, 300118), 'T': (279209, 295742), 'W': (305997, 316501), 'V': (300118, 305997), 'Y': (318640, 320784), 'X': (316501, 318640), 'Z': (320784, 323427), 'a': (323427, 473364), 'c': (647993, 822078), 'b': (473364, 647993), 'e': (956359, 1055476), 'd': (822078, 956359), 'g': (1148489, 1251197), 'f': (1055476, 1148489), 'i': (1340777, 1397212), 'h': (1251197, 1340777), 'k': (1446247, 1548597), 'j': (1397212, 1446247), 'm': (1653128, 1829032), 'l': (1548597, 1653128), 'o': (1917681, 1977123), 'n': (1829032, 1917681), 'q': (2131121, 2142578), 'p': (1977123, 2131121), 's': (2260704, 2514724), 'r': (2142578, 2260704), 'u': (2658390, 2705672), 't': (2514724, 2658390), 'w': (2756930, 2818844), 'v': (2705672, 2756930), 'y': (2832017, 2856318), 'x': (2818844, 2832017), 'z': (2856318, 2876999)}},
    8:{"name":"8.dic", "handle":None, "letterIndex":{'!': (0, 12), "'": (12, 80), '-': (80, 998), '1': (1013, 1154), '0': (998, 1013), '3': (1197, 1214), '2': (1154, 1197), '4': (1214, 1231), '9': (1261, 1274), '8': (1231, 1261), 'A': (1274, 24846), 'C': (43467, 69671), 'B': (24846, 43467), 'E': (85231, 95372), 'D': (69671, 85231), 'G': (107049, 120127), 'F': (95372, 107049), 'I': (132813, 140766), 'H': (120127, 132813), 'K': (146177, 154625), 'J': (140766, 146177), 'M': (168935, 196841), 'L': (154625, 168935), 'O': (208459, 215965), 'N': (196841, 208459), 'Q': (235287, 236720), 'P': (215965, 235287), 'S': (246846, 273895), 'R': (236720, 246846), 'U': (289786, 294936), 'T': (273895, 289786), 'W': (300564, 308184), 'V': (294936, 300564), 'Y': (310294, 312075), 'X': (308184, 310294), 'Z': (312075, 313773), 'a': (313773, 479481), 'c': (673704, 895917), 'b': (479481, 673704), 'e': (1052303, 1198914), 'd': (895917, 1052303), 'g': (1315322, 1427591), 'f': (1198914, 1315322), 'i': (1536098, 1606557), 'h': (1427591, 1536098), 'k': (1652397, 1754130), 'j': (1606557, 1652397), 'm': (1870155, 2072972), 'l': (1754130, 1870155), 'o': (2176624, 2248630), 'n': (2072972, 2176624), 'q': (2440930, 2452951), 'p': (2248630, 2440930), 's': (2591412, 2897413), 'r': (2452951, 2591412), 'u': (3067655, 3128469), 't': (2897413, 3067655), 'w': (3184037, 3253385), 'v': (3128469, 3184037), 'y': (3267127, 3298246), 'x': (3253385, 3267127), 'z': (3298246, 3314195)}},
    9:{"name":"9.dic", "handle":None, "letterIndex":{"'": (0, 18), '-': (18, 414), '1': (414, 478), '7': (478, 510), '9': (510, 542), 'A': (542, 23377), 'C': (40044, 65547), 'B': (23377, 40044), 'E': (78772, 88094), 'D': (65547, 78772), 'G': (98100, 108994), 'F': (88094, 98100), 'I': (120843, 128474), 'H': (108994, 120843), 'K': (132844, 139266), 'J': (128474, 132844), 'M': (150943, 175846), 'L': (139266, 150943), 'O': (186913, 193695), 'N': (175846, 186913), 'Q': (210827, 211713), 'P': (193695, 210827), 'S': (220476, 246173), 'R': (211713, 220476), 'U': (260552, 265753), 'T': (246173, 260552), 'W': (270617, 278245), 'V': (265753, 270617), 'Y': (280111, 281280), 'X': (278245, 280111), 'Z': (281280, 282682), 'a': (282682, 425832), 'c': (588860, 782645), 'b': (425832, 588860), 'e': (906578, 995975), 'd': (782645, 906578), 'g': (1102828, 1192115), 'f': (995975, 1102828), 'i': (1289930, 1354785), 'h': (1192115, 1289930), 'k': (1380611, 1451806), 'j': (1354785, 1380611), 'm': (1537448, 1700134), 'l': (1451806, 1537448), 'o': (1771367, 1837644), 'n': (1700134, 1771367), 'q': (2020753, 2031474), 'p': (1837644, 2020753), 's': (2139460, 2405683), 'r': (2031474, 2139460), 'u': (2543756, 2613427), 't': (2405683, 2543756), 'w': (2660423, 2722142), 'v': (2613427, 2660423), 'y': (2732621, 2743555), 'x': (2722142, 2732621), 'z': (2743555, 2756552)}},
}

def convertFiles():
    """Takes wordlists, copies, calculates and appends frequency, concatenates
    and splits based on length, then sorts by first character."""
    lines = 0
    maxLength = 0
    tempFiles = []
    for fn in wordsOrder:
        fIn = open(os.path.join(workPath, fn), "r")

        # Save for deletion later
        fnOut = os.path.join(wordPath, fn)
        tempFiles.append(fnOut)
        fOut = open(fnOut, "w")
        for line in fIn:
            lines += 1
            length = len(line.rstrip("\n\r"))
            if length > maxLength:
                maxLength = length
            fOut.write("{}\t{}\n".format(line.rstrip("\n\r"), lines))
        fIn.close()
        fOut.close()

    # Create new files: "len1, len2", etc (no zero padding)
    lenFiles = {}
    for i in range(1, maxLength + 1):
        lenFiles[i] = open(
            os.path.join(wordPath, str(i) + ".dic"), "w")

    for fn in wordsOrder:
        fIn = open(os.path.join(wordPath, fn), "r")
        for line in fIn:
            length = len(line.split("\t")[0])
            lenFiles[length].write(line)
        fIn.close()

    for fn in lenFiles.values():
        fn.close()

    # Sort and remove duplicates. Slow, but only runs once on wordlist changes
    for fn in lenFiles:
        f = open(os.path.join(wordPath, str(fn) + ".dic"), "r")

        # Remove duplicates and keep the lower line numbers
        lines = {}
        for line in f:
            base, count = line.rstrip("\n\r").split("\t")
            count = int(count)
            if base in lines and lines[base] > count:
                lines[line] = line
            else:
                lines[base] = count
        f.close()
        lines = sorted(["{}\t{}\n".format(k, v) for k, v in lines.iteritems()])
        f = open(os.path.join(wordPath, str(fn) + ".dic"), "w")
        for line in lines:
            f.write(line)
        f.close()

    for fn in tempFiles:
        os.remove(fn)

def indexFiles():
    for fn in os.listdir(wordPath):
        maxLength = 0
        if not fn.endswith(".dic"):
            continue
        size = int(os.stat(os.path.join(wordPath, fn)).st_size)
        f = open(os.path.join(wordPath, fn), "r")
        if not size:
            continue
        contents = mmap.mmap(f.fileno(), size, access=mmap.ACCESS_READ)
        f.close()

        # Letter indexing
        letterIndex = {}
        stack = []
        lastPos = 0

#        for letter in sorted(string.printable):
#            start = None
#
#            # Get around Python file iteration not playing well with .tell()
#            while True:
#                pos = contents.tell()
#                line = contents.readline()
#                if not line:
#                    break
#                if line[0] == letter:
#                    start = pos
#                    break
#            contents.seek(0)

        letterIndex = {}
        for letter in sorted(string.printable):
            result = re.search(r"^{}".format(re.escape(letter)), contents, re.M)
            if result:
                start = result.start()
                while len(stack) > 0:
                    stack.pop().append(start)
                letterIndex[letter] = [start,]
                stack.append(letterIndex[letter])
                lastPos = start
            #else:
                #letterIndex[letter] = None
                #stack.append(letterIndex[letter])
        while len(stack) > 0:
            element = stack.pop()
            if element[0]:
                element.append(size)
            else:
                element.append(0)

        # Max length (no longer needed)
#        for line in iter(contents.readline, ""):
#            line = line.rstrip("\r\n")
#            if len(line.rstrip()) > maxLength:
#                maxLength = len(line)

        # Character set (no longer needed)
#        type = getType(contents)

        # Line count (no longer needed)
#        lines = 0
#        contents.seek(0)
#        while contents.readline():
#            lines += 1

        letterIndex = {k: tuple(v) for k, v in letterIndex.items()}
        print '{}:{{"name":"{}", "handle":None, "letterIndex":{}}},'.format(
            fn.split(".")[0], fn, letterIndex)

#def getType(item):
#    if re.search(r"[^a-zA-Z0-9'\n\r]", item):
#        return 3
#    if re.search(r"[^a-z'\n\r]", item):
#        return 2
#    elif not re.search(r"[^0-9\n\r]", item):
#        return 1
#    return 0

def openFiles():
    for fn in wordFiles.values():
        fn["handle"] = open(os.path.join("words", fn["name"]), "r")

def closeFiles():
    for fn in wordFiles:
        fn["handle"].close()

def findWord(word):
    # Open files if necessary
    if len(word) not in wordFiles:
        return False
    if wordFiles[1]["handle"] is None:
        openFiles()
    fn = wordFiles[len(word)]

    # Get the ASCII letter or character after the first
    first = word[0]
    if first not in fn["letterIndex"]:
        return False
    length = len(word)
    # Cheap(er) ways of skipping file searches
    # TODO: Index character set of file instead of using basic type

    #print "Searching file: {} for term: {}".format(fn["name"], word)
    location = binary_search.searchFile(
        fn["handle"],
        word,
        fn["letterIndex"][first][0],
        fn["letterIndex"][first][1],
        splitChar="\t")
    if location:
        #print "Word {} found after {} searches".format(word, location)
        return location
    return False

if __name__ == "__main__":
    #cProfile.run("findWord('illinois')")
    convertFiles()
    cProfile.run("indexFiles()")